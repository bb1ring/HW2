---
title: "p8105_hw2_SL5454"
output: html_document
date: "2024-09-28"
---

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
```

## Problem 1

```{r}
transit_df =
  read_csv("data/NYC_Transit_Subway_Entrance_And_Exit_Data.csv", 
           na = c("NA", "", ".")) |>
  janitor::clean_names()|>
  select(line:route11, entry, vending, entrance_type, ada)|>
  mutate(entry = ifelse(entry == "YES", 1, 0))
```

This dataset contains division, the name of subway lines, station names on each line, routes served at each station, station's longitude and latitude, station's orientation, whether the station has entry and vending, each station's entrance type, entrance's longitude and latitude, and ADA compliance. 
I clear the names of variables in the dataset, and selected the variables we need. I have changed variable "entry" from character to a numeric varible, result in 1868 rows and 32 colomns in the dataset. However, these data are still not tidy enough.

```{r}
stations = transit_df |>
  distinct(line, station_name)
n_stations = nrow(stations)

ada_stations = transit_df|>
  filter(ada == "TRUE") |>
  distinct(line, station_name)
n_ada = nrow(ada_stations)

no_vending = transit_df|>
  filter(vending == "NO")
prop_no_vending = nrow(transit_df) / nrow(no_vending)

```
There are 465 distinct stations.
84 stations are ADA compliant.
About 10.21% of station entrances/exits don't have vending allow entrance.

```{r}
route_df = transit_df |>
  mutate(across(route1:route11, as.character))|>
  pivot_longer(
    cols = route1:route11,
    names_to = "route_number",
    values_to = "route_name"
  )
  
a_stations = route_df|>
  filter(route_name == "A") |>
  distinct(line, station_name)

ada_a_stations = route_df |>
  filter(route_name == "A", ada == "TRUE") |>
  distinct(line, station_name)
```
There are 60 distinct stations serve the A train.
17 of the stations that serve the A trains are ADA compliant.

## Problem 2

```{r}
mr_trash = 
  read_excel("data/Trash Wheel Collection Data.xlsx", sheet = "Mr. Trash Wheel",
             range = "A2:N653", na = c("NA", "", ".")) |>
  janitor::clean_names() |>
  mutate(sports_balls = as.integer(round(sports_balls, 0)),
         trash_wheel_name = "Mr.Trash Wheel",
         year = as.character(year)) 

prof_trash = 
  read_excel("data/Trash Wheel Collection Data.xlsx", sheet = "Professor Trash Wheel",
             range = "A2:M120", na = c("NA", "", ".")) |>
  janitor::clean_names() |>
  mutate(trash_wheel_name = "Professor Trash Wheel",
         year = as.character(year))

gwynnda = 
  read_excel("data/Trash Wheel Collection Data.xlsx", sheet = "Gwynnda Trash Wheel",
             range = "A2:L265", na = c("NA", "", ".")) |>
  janitor::clean_names() |>
  mutate(trash_wheel_name = "Gwynnda",
         year = as.character(year))
```

```{r}
combined_data = 
  bind_rows(mr_trash, prof_trash, gwynnda)|>
  rename(date_of_collection = date,
         month_of_collection = month,
         year_of_collection = year)|>
  arrange(dumpster, year_of_collection) |>
  mutate(glass_bottles = coalesce(glass_bottles, 0),
         wrappers = coalesce(wrappers, 0),
         sports_balls = coalesce(sports_balls, 0))
```

```{r}
prof_trash_weight = prof_trash |>
  pull(weight_tons) |>
  sum()

gwynnda_cig = gwynnda |>
  filter(month == 6 & year == 2022) |>
  pull(cigarette_butts) |>
  sum()
```

